!function(e,a){"function"==typeof define&&define.amd?define(a):"object"==typeof exports?module.exports=a():e.Blazy=a()}(this,function(){function e(e){setTimeout(function(){var t=e._util;t.elements=o(e.options.selector),t.count=t.elements.length,t.destroyed&&(t.destroyed=!1,e.options.container&&r(e.options.container,function(e){m(e,"scroll",t.validateT)}),m(window,"resize",t.saveViewportOffsetT),m(window,"resize",t.validateT),m(window,"scroll",t.validateT)),a(e)},1)}function a(e){for(var a=e._util,t=0;t<a.count;t++){var n=a.elements[t],o=n.getBoundingClientRect();(o.right>=g.left&&o.bottom>=g.top&&o.left<=g.right&&o.top<=g.bottom||i(n,e.options.successClass))&&(e.load(n),a.elements.splice(t,1),a.count--,t--)}0===a.count&&e.destroy()}function t(e,a,t){if(!i(e,t.successClass)&&(a||t.loadInvisible||0<e.offsetWidth&&0<e.offsetHeight))if(a=e.getAttribute(f)||e.getAttribute(t.src)){a=a.split(t.separator);var o=a[d&&1<a.length?1:0],c="img"===e.nodeName.toLowerCase();c||void 0===e.src?(a=new Image,a.onerror=function(){t.error&&t.error(e,"invalid"),e.className=e.className+" "+t.errorClass},a.onload=function(){c?e.src=o:e.style.backgroundImage='url("'+o+'")',n(e,t)},a.src=o):(e.src=o,n(e,t))}else t.error&&t.error(e,"missing"),i(e,t.errorClass)||(e.className=e.className+" "+t.errorClass)}function n(e,a){e.className=e.className+" "+a.successClass,a.success&&a.success(e),r(a.breakpoints,function(a){e.removeAttribute(a.src)}),e.removeAttribute(a.src)}function i(e,a){return-1!==(" "+e.className+" ").indexOf(" "+a+" ")}function o(e){var a=[];e=document.querySelectorAll(e);for(var t=e.length;t--;a.unshift(e[t]));return a}function c(e){g.bottom=(window.innerHeight||document.documentElement.clientHeight)+e,g.right=(window.innerWidth||document.documentElement.clientWidth)+e}function m(e,a,t){e.attachEvent?e.attachEvent&&e.attachEvent("on"+a,t):e.addEventListener(a,t,!1)}function l(e,a,t){e.detachEvent?e.detachEvent&&e.detachEvent("on"+a,t):e.removeEventListener(a,t,!1)}function r(e,a){if(e&&a)for(var t=e.length,n=0;t>n&&!1!==a(e[n],n);n++);}function s(e,a,t){var n=0;return function(){var i=+new Date;a>i-n||(n=i,e.apply(t,arguments))}}var f,g,d;return function(n){if(!document.querySelectorAll){var i=document.createStyleSheet();document.querySelectorAll=function(e,a,t,n,o){for(o=document.all,a=[],e=e.replace(/\[for\b/gi,"[htmlFor").split(","),t=e.length;t--;){for(i.addRule(e[t],"k:v"),n=o.length;n--;)o[n].currentStyle.k&&a.push(o[n]);i.removeRule(0)}return a}}var o=this,m=o._util={};m.elements=[],m.destroyed=!0,o.options=n||{},o.options.error=o.options.error||!1,o.options.offset=o.options.offset||100,o.options.success=o.options.success||!1,o.options.selector=o.options.selector||".b-lazy",o.options.separator=o.options.separator||"|",o.options.container=o.options.container?document.querySelectorAll(o.options.container):!1,o.options.errorClass=o.options.errorClass||"b-error",o.options.breakpoints=o.options.breakpoints||!1,o.options.loadInvisible=o.options.loadInvisible||!1,o.options.successClass=o.options.successClass||"b-loaded",o.options.validateDelay=o.options.validateDelay||25,o.options.saveViewportOffsetDelay=o.options.saveViewportOffsetDelay||50,o.options.src=f=o.options.src||"data-src",d=1<window.devicePixelRatio,g={},g.top=0-o.options.offset,g.left=0-o.options.offset,o.revalidate=function(){e(this)},o.load=function(e,a){var n=this.options;void 0===e.length?t(e,a,n):r(e,function(e){t(e,a,n)})},o.destroy=function(){var e=this._util;this.options.container&&r(this.options.container,function(a){l(a,"scroll",e.validateT)}),l(window,"scroll",e.validateT),l(window,"resize",e.validateT),l(window,"resize",e.saveViewportOffsetT),e.count=0,e.elements.length=0,e.destroyed=!0},m.validateT=s(function(){a(o)},o.options.validateDelay,o),m.saveViewportOffsetT=s(function(){c(o.options.offset)},o.options.saveViewportOffsetDelay,o),c(o.options.offset),r(o.options.breakpoints,function(e){return e.width>=window.screen.width?(f=e.src,!1):void 0}),e(o)}});
//# sourceMappingURL=lazy-min.js.map